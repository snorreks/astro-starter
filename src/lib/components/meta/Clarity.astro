---
// src/lib/components/base/Clarity.astro
/**
 * Integrates Microsoft Clarity for website analytics and session recording.
 * This script is loaded using Partytown to avoid blocking the main thread.
 */
type Props = {
  /** The Microsoft Clarity project ID. Required. */
  id: string;
};

const { id } = Astro.props;
---

<script type="text/partytown" define:vars={{ id }} is:inline>
  (function (c, l, a, r, i, t, y) {
    c[a] =
      c[a] ||
      function (...args) {
        (c[a].q = c[a].q || []).push(args);
      };
    t = l.createElement(r);
    t.async = 1;
    t.src = 'https://www.clarity.ms/tag/' + i;
    y = l.getElementsByTagName(r)[0];
    y.parentNode.insertBefore(t, y);
  })(globalThis, document, 'clarity', 'script', id);
</script>
